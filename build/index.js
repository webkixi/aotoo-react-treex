"use strict";function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function getBehaviorBar(e,t){if(t)switch(e){case"pulldown":return 1==t?bars.pulldown:t;case"loading":return 1==t?bars.loading:t;case"over":return 1==t?bars.over:t;case"trigger":return 1==t?bars.trigger:t}}function _getGroups(e,t){var r=[];return filter(e,function(e,r){if(e.parent==t)return indexcode.push(r),e.parent==t}).forEach(function(t,n){t.idf&&-1==idrecode.indexOf(t.idf)?(idrecode.push(t.idf),r=r.concat(t).concat(_getGroups(e,t.idf))):r=r.concat(t)}),r}function findParents(e,t){var r=void 0,n=[],a=find(e,function(e,r){return e.idf==t});if(a&&a.parent){var o=find(e,function(e,t){return r=t,e.idf==a.parent});o&&(n.push({index:r,content:o}),n.concat(findParents(e,a.parent)))}return n}function updateTreeKeys(e,t,r){var n=e.saxer.get("treeKeys"),a=findIndex(n,{hashKey:t});r?n[a].key=r:n.splice(a,1)}function valideIndex(e){return!(!e&&0!=e)}function getHashKey(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"treex_";return uniqueId(e)}function saveTreeKeys(e,t){t=t?[].concat(t):[],e.saxer.set("treeKeys",t)}function setItemKey(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments[2],n=arguments[3],a=arguments[4],o=[],i=[],s=0,d=e.startIndex||0;s<e.length;s++,d++){var c=e[s],u=getHashKey(),l=valideIndex(r)?{index:d,hashKey:u,depth:t,belong:{hashKey:n,part:a}}:{index:d,hashKey:u,depth:t};if(i.push(l),isString(c)||isNumber(c)||React.isValidElement(c)){var f={title:c,key:u};o.push(f)}else if(isObject(c)){c.key=c.key||u;var p=setSubItemKey(c,d,u,++t),h=_slicedToArray(p,2),v=h[0],y=h[1];i.concat(v),o.push(y)}}return[i,o]}function setSubItemKey(e,t,r,n){var a=[],o=[],i=[],s=[];if(e.li){var d=setItemKey([].concat(e.li),n,t,r,"li"),c=_slicedToArray(d,2),u=c[0],l=c[1];a=u,e.li=l}if(e.body){var f=setItemKey([].concat(e.body),n,t,r,"body"),p=_slicedToArray(f,2),h=p[0],v=p[1];o=h,e.body=v}if(e.footer){var y=setItemKey([].concat(e.footer),n,t,r,"footer"),g=_slicedToArray(y,2),m=g[0],b=g[1];i=m,e.footer=b}if(e.dot){var _=setItemKey([].concat(e.dot),n,t,r,"dot"),A=_slicedToArray(_,2),x=A[0],K=A[1];s=x,e.dot=K}return[[].concat(_toConsumableArray(a),_toConsumableArray(o),_toConsumableArray(i),_toConsumableArray(s)),e]}function App(e){var t=setItemKey(e.props.data),r=_slicedToArray(t,2),n=r[0],a=r[1];e.props.data=a||[];var o=Aotoo(Tree,Actions,e);return saveTreeKeys(o,n),o.extend({setProps:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(e.data){var t=setItemKey(e.data),r=_slicedToArray(t,2),n=r[0],a=r[1];e.data=a||[],saveTreeKeys(this,n),this.config.props=e}},setConfig:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(e.props&&e.props.data){var t=setItemKey(e.props.data),r=_slicedToArray(t,2),n=r[0],a=r[1];e.props.data=a||[],saveTreeKeys(this,n),this.config=e}},update:function(e){this.$update(e)},append:function(e){this.$append(e)},prepend:function(e){this.$prepend(e)},delete:function(e){this.$delete(e)},loading:function(e){this.$loading(e)},loaded:function(e){this.$loaded(e)},over:function(e){this.$over(e)},pulldown:function(e){this.$pulldown(e)},trigger:function(e){this.$trigger(e)},getGroups:function(e,t,r){e=e||this.data||[],idrecode=[],indexcode=[];var n=findIndex(e,function(e){return e.idf==t});indexcode.push(n);_getGroups(e||[],t);if(r){var a=[];return indexcode.forEach(function(t){var r=e[t];r.__index=t,a.push(r)}),a}return indexcode},getParents:function(e,t){return e=e||this.data||[],findParents(e,t)},findAndUpdate:function(e,t){var r=this.data||[];if(e){var n=findIndex(r,e);n&&this.dispach("UPDATE",{index:n,data:t})}}}),o}function tree(e){var t={props:{data:[],loading:!1,header:"",footer:"",itemClass:"",listClass:"",itemMethod:""},theme:"",autoinject:!0,rendered:""};return t=merge(t,e),App(t)}function pure(e){return tree(e)}Object.defineProperty(exports,"__esModule",{value:!0});var _slicedToArray=function(){function e(e,t){var r=[],n=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(a)throw o}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();exports.default=tree,exports.pure=pure;var _Aotoo=Aotoo,list=_Aotoo.list,objTypeof=_Aotoo.objTypeof,transTree=_Aotoo.transTree,find=_Aotoo.find,findIndex=_Aotoo.findIndex,merge=_Aotoo.merge,isArray=_Aotoo.isArray,isFunction=_Aotoo.isFunction,isString=_Aotoo.isString,isObject=_Aotoo.isObject,isDomElement=_Aotoo.isDomElement,uniqueId=_Aotoo.uniqueId,filter=_Aotoo.filter,isNumber=function(e){return"Number"==objTypeof(e)},bars={trigger:React.createElement("div",{className:"treex-bar"},React.createElement("div",{className:"treex-trigger-bar"},"加载更多内容")),pulldown:React.createElement("div",{className:"treex-bar"},React.createElement("div",{className:"treex-pull-bar"},"刷新页面")),loading:React.createElement("div",{className:"treex-bar"},React.createElement("div",{className:"treex-loading"},"Loading...")),over:React.createElement("div",{className:"treex-bar"},React.createElement("div",{className:"treex-over-bar"},"没有更多内容了"))},Tree=function(e){function t(e){_classCallCheck(this,t);var r=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.preRender=r.preRender.bind(r),r.state={data:r.props.data||[],pulldown:r.props.pulldown||!1,loading:r.props.loading||!1,trigger:r.props.trigger||!1,over:r.props.over||!1},r}return _inherits(t,e),_createClass(t,[{key:"preRender",value:function(){var e=this.props.header?this.props.header:"",t=this.props.footer?this.props.footer:"",r=list({data:transTree(this.state.data),listClass:this.props.listClass,itemClass:this.props.itemClass,itemMethod:this.props.itemMethod});return e||t||this.state.trigger||this.state.pulldown||this.state.loading||this.state.over?React.createElement("div",{className:"list-container"},getBehaviorBar("pulldown",this.state.pulldown),e,r,t,getBehaviorBar("trigger",this.state.trigger),getBehaviorBar("over",this.state.over),getBehaviorBar("loading",this.state.loading)):r}},{key:"render",value:function(){return this.preRender()}}]),t}(React.Component),Actions={UPDATE:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments[2],n=this.curState,a=n.data,o=t.index;if(o||0==o){var i=a[o],s=i.key,d=getHashKey();return updateTreeKeys(r,s,d),n.data[o]=merge(i,t.data,{key:d}),n}if(isArray(t.data)){var c=setItemKey(t.data),u=_slicedToArray(c,2),l=u[0],f=u[1];return r.saxer.set("treeKeys",l||[]),n.data=f,n}},APPEND:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments[2],n=this.curState,a=n.data,o=r.saxer.get("treeKeys"),i=setItemKey([].concat(t.data||[])),s=_slicedToArray(i,2),d=s[0],c=s[1];return o=o.concat(d),r.saxer.set("treeKeys",o||[]),a=a.concat(c),n.data=a,n},PREPEND:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments[2],n=this.curState,a=n.data,o=r.saxer.get("treeKeys"),i=setItemKey([].concat(t.data||[])),s=_slicedToArray(i,2),d=s[0],c=s[1];return o=d.concat(o),r.saxer.set("treeKeys",o||[]),a=c.concat(a),n.data=a,n},DELETE:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments[2],n=this.curState,a=n.data;r.saxer.get("treeKeys");if(t.index||0==t.index){var o=a[t.index],i=o.key;o&&(updateTreeKeys(r,i),a.splice(t.index,1))}else if(t.query){var s=findIndex(a,t.query),d=a[s],c=d.key;d&&(updateTreeKeys(r,c),a.splice(s,1))}return n.data=a,n},LOADING:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.curState;return r.over||(r.loading=t.loading||!0,r.pulldown=!1),r},LOADED:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];var t=this.curState;return t.over||(t.loading=!1,t.pulldown=!1),t},OVER:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.curState;return r.loading=!1,r.pulldown=!1,r.trigger=!1,r.over=t.over||!0,r},PULLDOWN:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.curState;return r.loading=!1,r.over=!1,r.pulldown=t.pulldown||!0,r},TRIGGER:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this&&this.state){var r=this.curState;return r.loading=!1,r.pulldown=!1,r.over=!1,r.trigger=t.trigger||!0,r}}},idrecode=[],indexcode=[];
//# sourceMappingURL=maps/index.js.map
