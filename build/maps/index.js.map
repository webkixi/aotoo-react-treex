{"version":3,"sources":["index.js"],"names":["isArray","val","isFunction","isString","type","isObject","isDomElement","filter","bars","loading","isNumber","objTypeof","over","trigger","DELETE","dataAry","ostate","nsons","o","jj","state","idf","indexcode","data","oTreeKeys","control","forEach","son","ii","oriItem","tIndex","idrecode","push","oldKey","key","concat","_getGroups","updateTreeKeys","findParents","_parentIndex","myParents","LOADING","find","item","parent","curState","opts","p","index","content","oldkey","newKey","saxer","get","treeKeys","hashKey","splice","arguments","length","undefined","uniqueId","prefix","PULLDOWN","params","set","setItemKey","datas","depth","parentIndex","hkey","part","myData","myKeys","startIndex","getHashKey","valideIndex","itemKey","belong","keyItem","React","isValidElement","newItem","title","setSubItemKey","subItemKeys","sons","indexOf","_ftKeys","_dotKeys","li","_liKeys","liKeys","liData","body","_setItemKey9","_setItemKey10","_slicedToArray","bodyKeys","bodyData","_bodyKeys","footer","_setItemKey11","_setItemKey12","ftKeys","ftData","_setItemKey13","dot","_setItemKey14","dotKeys","dotData","itemKeys","_toConsumableArray","App","_setItemKey15","props","_setItemKey16","treeInitData","treeX","Aotoo","Tree","Actions","saveTreeKeys","extend","setProps","findIndex","_setItemKey17","_setItemKey18","this","config","setConfig","_setItemKey19","_setItemKey20","update","$append","prepend","$prepend","delete","that","param","setTimeout","$delete","$loading","$loaded","$pulldown","getGroups","feather","sonFeather","$id","temp","getParents","findAndUpdate","query","target","dispach","tree","header","itemClass","listClass","itemMethod","theme","dft","merge","pure","list","transTree","obj","createElement","className","_classCallCheck","_this","_possibleConstructorReturn","__proto__","Object","getPrototypeOf","call","preRender","bind","pulldown","list_part","getBehaviorBar","Component","UPDATE","oriData","treeData","APPEND","_setItemKey3","_setItemKey4","attr","data-treeid","appendData","LOADED","OVER","PREPEND"],"mappings":"iwBA4BA,SApBEA,eAAAA,EAoB4BC,GAC5B,GApBAC,EACAC,OAoBUC,GAnBVC,IAAAA,WACAC,OAoBoB,GApBpBA,EAAAA,KAAAA,SAoB2CL,EAlB3CM,IAoBS,UACH,OAAc,GAAPN,EAAcO,KAAKC,QAAUR,EAlBtCS,IAAAA,OACJ,OAAO,GAAAC,EAAkBH,KAAAI,KAAzBX,EAsBI,IAAK,UAnBLO,OAAO,GAAAP,EAAAO,KAAAK,QAAAZ,GA4IXa,SAAAA,WAAQC,EAASC,GAAyB,IAAAC,KAevC,OAmEQV,OAAOQ,EAAS,SAACG,EAAGC,GAjF7B,GAAIC,EAAAA,QAAQC,EAEZ,OADAC,UAAWF,KAAMG,GACbC,EAAAA,QAAYC,IAsFbC,QAAS,SAACC,EAAKC,GAjFhBD,EAAIE,MAAJ,GAAIA,SAAeC,QAAnBH,EAAAN,MACAU,SAAAC,KAAAL,EAAAN,KACAJ,EAAIgB,EAASJ,OAAQK,GAArBC,OAAAC,WAAArB,EAAAY,EAAAN,OAEEgB,EAAAA,EAAAA,OAAeZ,KAPnBR,EAwGJ,SAASqB,YAAYvB,EAASM,GAhF5B,IAAAkB,OAAAA,EAkFMC,KAhFNC,EAASC,KAAA3B,EAASC,SAAAA,EAAAA,GAAAA,OAAgBE,EAAAG,KAAAA,IAmFlC,GAAIsB,GAAQA,EAAKC,OAAQ,CAlFvB,IAAIxB,EAAAA,KAAQL,EAAK8B,SAAjB3B,EAAAU,GAEER,OADFmB,EAAiBX,EACTnB,EAAAA,KAANkC,EAAgBG,SAEjBC,IACDP,EAAAR,MAAAgB,MAAAT,EAAAU,QAAAF,IAlGYP,EAAAL,OAAAG,YAAAvB,EAAA4B,EAAAC,UAqGmB,OAARE,EAEvB,SAAK1B,eAAYK,EAAAyB,EAAAC,GACf/B,IAAAA,EAAAK,EAAA2B,MAAAC,IAAA,YACAjC,EAAAA,UAAAkC,GAAAC,QAAAL,IACDC,EACDG,EAAOlC,GAAPc,IAAAiB,EAuFAG,EAASE,OAAO5B,EAAI,GAnFpB,SAAIR,YAAayB,GACjBzB,SAAAA,GAAA,GAAA4B,GAGA5B,SAAAA,aAAA,IAAa0B,EAAbW,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAa,SACb,OAAAG,SAAAC,GAGFC,SAAAA,aAAUrC,EAAST,GAAgB+C,EAARjB,KAAQX,OAAA4B,MAyFnCtC,EAAQ2B,MAAMY,IAAI,WAAYD,GApF5B,SAAAE,aA8FF,IAAK,IA9FHC,EAAAT,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,MAAAU,EAAAV,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAA,EAAAW,EAAAX,UAAA,GAAAY,EAAAZ,UAAA,GAAAa,EAAAb,UAAA,GA5HYc,KAuNRC,KAGG5C,EAAK,EAAGT,EA3FR+C,EAAAO,YAASzD,EA2FWY,EAAKsC,EAAMR,OAAQ9B,IAAMT,IAAM,CA1F1D,IAAIwB,EAAAuB,EAAQtC,GACRR,EAAQsD,aACZtD,EAAAuD,YAAAP,IAEAhD,MAAAD,EAAaoC,QAAbqB,EAAAT,MAAAA,EAAAU,QAAAtB,QAAAc,EAAAC,KAAAA,KACAlD,MAAMP,EAAN0C,QAAqB1C,EAAWsD,MAAhCA,GArIJ,GAsIIK,EAAOpD,KAAP0D,GAtIJ3E,SAAAwC,IAAAjC,SAAAiC,IAAAoC,MAAAC,eAAArC,GAAA,CAoOM,IAAMsC,GAAWC,MAAOvC,EAAMT,IAAK0C,GA1FrC7C,EAAAA,KAAJkD,QAES7C,GAAAA,SAAWrB,GAASM,CACvBJ,EAAAA,IAAJ0B,EAAAT,KAAA0C,EAD2BvD,IAAAA,EA6FQ8D,cAAcxC,EAAMxB,EAAIyD,IAAWT,GA7F3C9C,EAAAA,eAAAA,EAAAA,GA6FhB+D,EA7FgB/D,EAAAA,GA6FH4D,EA7FG5D,EAAAA,GAGvBgE,EAAO9E,OAAOQ,GAChBwD,EAAM3B,KAAFqC,IAIL,OALDT,EAAAD,GAQE,SAAI5C,cAAWI,EAASuD,EAAQ3D,EAAjBwC,GACbpC,IAAAA,KAASC,KAATuD,KAAAC,KACAvE,GAAAA,EAAAA,GAAQA,CACT,IADSA,EAEaU,cADhBQ,OAAAQ,EAAA8C,IACLtB,EAAAnB,EAAAO,EAAA,MAFQtC,EAAAA,eAAAA,EAAAA,GAERA,EAFQA,EAAAA,GAEAA,EAFAA,EAAAA,GAGTyE,EAAAC,EANHhD,EAAA8C,GAAAG,EAqGA,GAAIjD,EAAKkD,KAAM,CA1FjB,IA0FiBC,EAzFjB7B,cADA9B,OAAAQ,EAAAkD,MACA1B,EAAAnB,EAAAO,EAAA,QAyFiBwC,EAAAC,eAAAF,EAAA,GAzFjBG,EAyFiBF,EAAA,GAzFjBG,EAyFiBH,EAAA,GAGbI,EAAYF,EA1FhBtD,EAAAkD,KAAAK,EA8FE,GAAIvD,EAAKyD,OAAQ,CACf,IADeC,EAEQpC,cADP9B,OAAOQ,EAAKyD,QACcjC,EAAOnB,EAAOO,EAAS,UAFlD+C,EAAAN,eAAAK,EAAA,GAEVE,EAFUD,EAAA,GAEFE,EAFEF,EAAA,GAxFnBf,EAASjD,EACPK,EAAIJ,OAAAA,EAEuB,GAAAI,EAAQzB,IAAA,CAAnC,IAAmCuF,EA8FRxC,cA9F3B9B,OAAAQ,EAAA+D,KA8F2CvC,EAAOnB,EAAOO,EAAS,OA9F/BoD,EAAAX,eAAAS,EAAA,GA8F5BG,EA9F4BD,EAAA,GA8FnBE,EA9FmBF,EAAA,GAEnCnB,EAAY7C,EACVA,EAAMI,IAAIL,EAIV,UAJAoE,OAAAA,mBAAApB,GAAAqB,mBAAAZ,GAAAY,mBAAAxB,GAAAwB,mBAAAvB,IAIM7C,GAGL,SAAAqE,IAAAlE,GAAA,IAAAmE,EACFhD,WAAAnB,EAAAoE,MAAA3F,MADE4F,EAAAnB,eAAAiB,EAAA,GACF3D,EADE6D,EAAA,GACFC,EADED,EAAA,GAEHrE,EAAAoE,MAAO1E,KAAP4E,MACD,IAAAC,EAAAC,MAAAC,KAAAC,QAAA1E,GAwEkB,OAsBjB2E,aAAaJ,EAAO/D,GA5FtB+D,EAAAK,QAEEC,SAASC,WAAqBrE,IAAXD,EAAWC,UAAAA,OAAAA,QAAAA,IAAAA,UAAAA,GAAAA,UAAAA,MAC1BJ,GAAAA,EAAQ5B,KAAA,CAAA,IAAAsG,EACV5D,WAAAiD,EAAA3F,MADUuG,EAAA9B,eAAA6B,EAAA,GACVvE,EADUwE,EAAA,GACS3E,EADT2E,EAAA,GAAZZ,EAEO3F,KAAA6F,MACL9D,aAAgB1B,KAAhB0B,GACDyE,KAAAC,OAAAd,MAAAA,IAIDe,UAAOjF,WAA6B,IAApBA,EAAoBS,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,MACrC,GAAAuE,EAAAd,OAAAc,EAAAd,MAAA3F,KAAA,CAAA,IAAA2G,EA8FwCjE,WAAW+D,EAAOd,MAAM3F,MA9FhE4G,EAAAnC,eAAAkC,EAAA,GA8Fc5E,EA9Fd6E,EAAA,GA8FwBf,EA9FxBe,EAAA,GAEDH,EAAStD,MAATnD,KAAqC6F,MAAjBvD,aAAiBkE,KAAAzE,GA+F7ByE,KAAKC,OAASA,IAGlBI,OAAQ,SAASrE,GA9FrBgE,KAASN,QAAAA,IAEPhG,OAAQ2B,SAAUW,GAClBgE,KAAAM,QAAAtE,IADAuE,QAAA,SAAAvE,GAGDgE,KAAAQ,SAAAxE,IAEDyE,OAASvE,SAATF,GAAoBG,IAA4CuE,EAAAV,KAAlC5D,IAASC,MAAyBpE,QAAA+D,GAAAA,EAAArC,QAAA,SAAAgH,GAAAC,WAAA,WAsGlDF,EAAKG,QAAQF,IArGV,MAyGPX,KAAKa,QAAQ7E,KAlGnBtD,QAAIqE,SAAUH,GACdoD,KAAAc,SAAA9E,IAGAS,OAAOxC,SAAK8C,GAsGViD,KAAKe,QAAQ/E,IAnGbnD,KAAMqE,SAAAA,GACNV,KAAAA,MAAAR,IAGApB,SAAA,SAAgBT,GAqGhB6F,KAAKgB,UAAUhF,IAtGQlD,QAAA,SAAAkD,GAAAgE,KAEhB3C,SAAAA,IA8GT4D,UAAW,SAASzH,EAAMF,EAAK4H,GAxGjC1H,EAAQiD,GAAQD,KAAThD,SACRQ,YA0GKT,aAxGN,IAAS6D,EAAAA,UAAoBnC,EAAOO,SAAAA,GAAAA,OAAAA,EAAAA,KAASY,IACvCuB,UAAQ1D,KAAZgB,GAA0BZ,WAA1Bb,MAAAF,GAA0CmE,GAAAA,EAA1C,CACI7C,IAAK8C,KAEMG,OADTH,UAAQtD,QAAOQ,SAAAA,GA6Gb,IAAIuG,EAAa3H,EAAK4H,GA9GjBD,EAAA,QAEuBzD,EAFvB2D,EAAApH,KAAAkH,KAAAE,EAGX1D,OAAAA,WAoHA2D,WAAY,SAAS9H,EAAMF,GA/G3B,OADEsB,EAAKkD,GAAMkC,KAAAxG,SACTsE,YAAiBlD,EAAKkD,IADbyD,cAAA,SAAAC,EAAAC,GAAA,IAERvD,EAFQ8B,KAAAxG,SAAA,GAEE2E,EAFF,CAwHT,IAAMlD,EAAQ4E,UAAUrG,EAAMgI,GArHlCpD,GACKN,KAAL4D,QAAYvD,UACblD,MAAAA,EAuHSzB,KAAMiI,QAnHTjD,EACKA,SAAVmD,KAAA5G,GACAH,IAAAA,GACDuE,OA4HG3F,QA1HAoB,SAAJ,EACEgH,OAAU,GA4HRvD,OAAQ,GA7HEwD,UAAA,GAAAC,UAAA,GAAAC,WAAA,IAkIZC,MAAO,GA/HPvE,YAAWoB,EACXjE,SAAA,IAGF,OA+HAqH,EAAMC,MAAMD,EAAKlH,GA/HXgE,IAAAA,GAmID,SAASoD,KAAKpH,GA/HrB,OAASkE,KAAIlE,iwBAfT4G,aA8IYQ,KAAAA,gBAxeZ5C,MAbF6C,YAAAA,KACAxJ,iBAAAA,UACAyJ,iBAAAA,UACA1H,YAAAA,KACAkF,iBAAAA,UACAqC,aAAAA,MACAjK,eAAAA,QACAE,kBAAAA,WACAC,gBAAAA,SACAE,gBAAAA,SACAC,oBAAAA,aACAsD,gBAAAA,SACArD,cAAAA,OAGIG,SAAW,SAAU2J,GACzB,MAAyB,UAAlB1J,UAAU0J,IAGb7J,MAnBJ2J,QAoBYpF,MAAAuF,cAAA,OApBZH,UAoB2B,aAAYpF,MAAAuF,cAAA,OAAKC,UAAU,qBAAf,WAnBvC5J,SAoBYoE,MAAAuF,cAAA,OAAKC,UApBjB5J,aAoBuCoE,MAAAuF,cAAA,OAAKC,UAAU,kBAAf,SAnBvCH,QAoBYrF,MAAAuF,cAAA,OAAKC,UApBjBH,aAoBuCrF,MAAAuF,cAAA,OAAKC,UAAU,iBAAf,eAnBvC7H,KAoBYqC,MAAAuF,cAAA,OApBZ5H,UAoB2B,aAAYqC,MAAAuF,cAAA,OAAKC,UAAU,kBAAf,aAHAhD,iBAAA,SAAAA,EAAAL,GAAAsD,gBAAAzC,KAAAR,GAAA,IAAAkD,EAAAC,2BAAA3C,MAAAR,EAAAoD,WAAAC,OAAAC,eAAAtD,IAAAuD,KAAA/C,KAAAb,IAAA,OAD5BuD,EAAAM,UAAAN,EAAAM,UAAAC,KAAAP,GAETQ,EAAAA,OAAU1J,KAAAkJ,EAAAvD,MAAA3F,SAAK0J,SAAAR,EAAUvD,MAAA+D,WAAf,EAA2BxK,QAAAgK,EAAAvD,MAAAzG,UAAA,EAAAI,QAAA4J,EAAAvD,MAAArG,UAAA,EAAAD,KAAK6J,EAAAvD,MAAUtG,OAAA,GADf6J,0EAE3B,IAAAd,EAAA5B,KAAAb,MAAAyC,OAAA5B,KAAAb,MAAAyC,OAAA,GAAKvD,EAAU2B,KAAAb,MAAfd,OAAA2B,KAAAb,MAAAd,OAAA,GAA2B8E,EAAAf,MAAA5I,KAAK6I,UAAUrC,KAAA3G,MAAAG,MAAfsI,UAAA9B,KAAAb,MAAA2C,UAAAD,UAAA7B,KAAAb,MAAA0C,UAH5BE,WAAA/B,KAAAb,MAAA4C,aAIC,OAA2BH,GAAAvD,GAAA2B,KAAK3G,MAAAP,SAALkH,KAAA3G,MAAA6J,UAAAlD,KAAA3G,MAAAX,SAA3BsH,KAAA3G,MAAAR,KAGdmE,MAAAuF,cAAA,OAASa,UAAT,kBACWA,eAAA,WAAApD,KAAA3G,MAAA6J,UACPtB,EACOuB,EACH9E,EACA+E,eAAA,UAAApD,KAAA3G,MAAAP,SACGsK,eAAL,OAAApD,KAAA3G,MAAAR,MACEuK,eAAO,UAAmB1K,KAAnBW,MAAPX,UAIAyK,mCAKL,OAAAnD,KAAAgD,mBAtBqDhG,MAAAqG,WA8ElD5D,SACJ6D,OAAQ,SAASrK,GAAyB,IAAjB8B,EAAiBW,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,MAARhC,EAAQgC,UAAA,GArD1CrC,EAAY8F,KAAZrE,SAAkBtB,EAAAH,EAAAG,KAAAyB,EAAAF,EAAAE,MA0DhB,GAAKA,GAAgB,GAAPA,EAlDZpC,CALF,IAAA0K,EAAA/J,EAAAyB,GAHgBf,EAAAqJ,EAAApJ,IAUjBiB,EAAAuB,aA6DG,OAFArC,eAAeZ,EAASQ,EAAQkB,GAChC/B,EAAMG,KAAKyB,GAASiH,MAAMqB,EAASxI,EAAKvB,MAAOW,IAAKiB,IAC7C/B,EArET,GAAK2J,QAAAA,EAAkBxJ,MAAKwJ,CAAAA,IAAAA,EACf9G,WAAAnB,EAAAvB,MADewJ,EAAAA,eAAAA,EAAAA,GAC5BzH,EAD4ByH,EAAAA,GACfQ,EADeR,EAAAA,GAI1BtK,OAFAc,EAAM6B,MAAK8D,IAAM3F,WADN+B,OAEX2H,EAAAA,KAAUM,EACDnK,IAqEboK,OAAQ,SAASxK,GAAyB,IAAjB8B,EAAiBW,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,MAARhC,EAAQgC,UAAA,GA3DxCrC,EAAM8J,KAAAA,SACJ3J,EAAM6I,EAAAA,KACNP,EAAWpI,EAAKyF,MAAM2C,IAAAA,YAyDgB4B,EAOXxH,cA/DXiD,OAAM0C,EAAAA,WAwDgB8B,EAAA1F,eAAAyF,EAAA,GAOjCnI,EAPiCoI,EAAA,GAOvBH,EAPuBG,EAAA,GAzCjC/B,OAXPnI,EACEmI,EAAAxH,OAEAmB,GAKA7B,EAAA2B,MACEY,IAAA,WAAAxC,OAAAD,EAAAA,EAAAY,OAAAoJ,GACGJ,EAAAA,KAAAA,EACAxB,GAGAwB,QAAAA,SAAAA,GAA+B/J,IAAhB0B,EAAgB1B,UAAAA,OAAAA,QAAAA,IAAAA,UAAAA,GAAAA,UAAAA,MAALK,EAAKL,UAAAA,GAC/B+J,EAAAA,KAAAA,SACAA,EAAAA,EAAAA,KAPH3J,EADFC,EAAA2B,MAAAC,IAAA,YAMoCjC,EAOrC6C,cAFM9B,OAAAW,EAAAvB,WAL+BH,EAAAA,eAAAA,EAAAA,GAOrCkC,EAPqClC,EAAAA,GAOrCmK,EAPqCnK,EAAAA,GAmEtC,OA3DDI,EAAA8B,EAAAnB,OAAAX,GAuDCC,EAAQ2B,MAAMY,IAAI,WAAYxC,OAC9BD,EAAOgK,EAASpJ,OAAOZ,GApDxBH,EAAAG,KAAAA,EAuDQH,GASTN,OAAQ,SAASE,GAAyB,IAAjB8B,EAAiBW,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,MAARhC,EAAQgC,UAAA,GA3DpCrC,EAAQ2G,KAAKlF,SACbtB,EAAOH,EAAMG,KA6DDE,EAAQ2B,MAAMC,IAAI,YA1DlC,GAAIP,EAACE,OAAmB,GAAVA,EAAOA,MAAG,CACtB,IAAIhD,EAAQ8C,UAAYvB,GAAAoK,MAAAC,cAAA9I,EAAAE,SAAAnB,EAAAN,EAAAO,GAAAG,EACLsJ,EADKrJ,IAiEpBL,IA/DFJ,eAAcuC,EAAI/B,GAClBb,EAAAA,OAAAU,EAAayJ,SAJjB,GAOOzI,EAAAyG,MAAA,CACL,IAAI+B,EAAU/J,UAAAA,EAAduB,EAAAyG,OACItH,EAASqJ,EAAAA,GACTnI,EAASuB,EAAAA,IACbrC,IACAjB,eAAAK,EAA0B6J,GAC1B/J,EAAOH,OAAP4B,EAAA,IAIJwI,OA+DEpK,EAAMG,KAAOA,EA/DPH,GAENqB,QAAIlB,SAAOH,GAAX,IAAA0B,EAAAW,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,MACIjC,EAAAA,KAAYC,SAHwB,OAIpCoK,EAAAA,OACJzK,EAAAX,QAAAqC,EAAArC,UAAA,EAoEEW,EAAM6J,UAAW,GAzEqB7J,GAAA0K,OAOvBP,SAPuBvK,GAAAyC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,IAAAA,UAAA,GAAA,IA+EpCrC,EAAQ2G,KAAKlF,SAnEjBzB,OAJAI,EAAAA,OACAC,EAAQ2B,SAAU,EAClB7B,EAAOA,UAAYgK,GAEbhK,GA2ERwK,KAAM,SAAS/K,GAAgB,IAAR8B,EAAQW,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,MAvE/BuI,EAASjE,KAAAlF,SAEP,OAFyCzB,EAAjB0B,SAAiB,EAAA1B,EAARK,UAAQ,EA2EzCL,EAAMP,SAAU,EA1EhBO,EAAIA,KAAQ0B,EAAKD,OAAjB,EACItB,GA8ENuC,SAAU,SAAS9C,GAAgB,IAAR8B,EAAQW,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,MAhFQrC,EAAA2G,KAAAlF,SAqFzC,OArFyCzB,EAAAX,SAAA,EAAAW,EAMlCkC,MANkC,EAAAlC,EAMxBmK,SANwBzI,EAAAmI,WAAA,EAqFlC7J,GA5EPK,QAAAA,SAAcuC,GAAgBxC,IAAZsB,EAAYtB,UAAAA,OAAAA,QAAAA,IAAAA,UAAAA,GAAAA,UAAAA,MAC9BD,GAAAA,MAAOgK,KAASpJ,MAAhBZ,CAgFA,IAAIH,EAAQ2G,KAAKlF,SA1EnB,OAJEzB,EAAMG,SAAOA,EACbH,EAAA6J,UAAA,EApDY7J,EAAAR,MAAA,EAqIZQ,EAAMP,QAAUiC,EAAKjC,UAAW,EA9ElCO,KAmFEW,YACAT","file":"../index.js","sourcesContent":["\nconst {\n  list,\n  objTypeof,\n  transTree,\n  find,\n  findIndex,\n  merge,\n  isArray,\n  isFunction,\n  isString,\n  isObject,\n  isDomElement,\n  uniqueId,\n  filter\n} = Aotoo\n\nconst isNumber = function (obj) {\n  return objTypeof(obj) == 'Number'\n}\n\nconst bars = {\n    trigger:  <div className=\"treex-bar\"><div className=\"treex-trigger-bar\">加载更多内容</div></div>\n  , pulldown: <div className=\"treex-bar\"><div className=\"treex-pull-bar\">刷新页面</div></div>\n  , loading:  <div className=\"treex-bar\"><div className=\"treex-loading\">Loading...</div></div>\n  , over:     <div className=\"treex-bar\"><div className=\"treex-over-bar\">没有更多内容了</div></div>\n}\n\nfunction getBehaviorBar(type, val){\n  if (val) {\n    switch (type) {\n      case 'pulldown':\n        return val == true ? bars.pulldown : val\n        break;\n      case 'loading':\n        return val == true ? bars.loading : val\n        break;\n      case 'over':\n        return val == true ? bars.over : val\n        break;\n      case 'trigger':\n        return val == true ? bars.trigger : val\n        break;\n    }\n  }\n}\n\nclass Tree extends React.Component {\n  constructor(props){\n    super(props)\n    this.preRender = this::this.preRender\n    this.state = {\n      data: this.props.data || [],\n      pulldown: this.props.pulldown || false,\n      loading: this.props.loading || false,\n      trigger: this.props.trigger || false,\n      over: this.props.over || false\n    }\n  }\n\n  preRender(){\n    const header = this.props.header ? this.props.header : ''\n    const footer = this.props.footer ? this.props.footer : ''\n\n    const list_part = list({\n      data: transTree(this.state.data),\n      listClass: this.props.listClass,\n      itemClass: this.props.itemClass,\n      itemMethod: this.props.itemMethod\n    })\n\n    if (\n      header ||\n      footer ||\n      this.state.trigger ||\n      this.state.pulldown ||\n      this.state.loading ||\n      this.state.over\n    ) {\n      return (\n        <div className=\"list-container\">\n          {getBehaviorBar('pulldown', this.state.pulldown)}\n          {header}\n          {list_part}\n          {footer}\n          {getBehaviorBar('trigger', this.state.trigger)}\n          {getBehaviorBar('over', this.state.over)}\n          {getBehaviorBar('loading', this.state.loading)}\n        </div>\n      )\n    } else {\n      return list_part\n    }\n  }\n\n  render(){\n    return this.preRender()\n  }\n}\n\nconst Actions = {\n  UPDATE: function(ostate, opts={}, control){\n    let state = this.curState\n    let data = state.data\n\n    const index = opts.index\n    if (!index && index!=0) {\n      if (isArray(opts.data)) {\n        const [treeKeys, treeData] = setItemKey(opts.data)\n        control.saxer.set('treeKeys', treeKeys||[])\n        state.data = treeData\n        return state\n      }\n    } else {\n      let oriData = data[index]\n      let oldKey = oriData.key\n      let newKey = getHashKey()\n      updateTreeKeys(control, oldKey, newKey)\n      state.data[index] = merge(oriData, opts.data, {key: newKey})\n      return state\n    }\n  },\n\n  APPEND: function(ostate, opts={}, control){\n    let state = this.curState\n    let data = state.data\n    let oTreeKeys = control.saxer.get('treeKeys')\n    let appendData = [].concat(opts.data || [])\n    // appendData.startIndex = oTreeKeys.length\n\n    const [treeKeys, treeData] = setItemKey(appendData)\n    oTreeKeys = oTreeKeys.concat(treeKeys)\n    control.saxer.set('treeKeys', oTreeKeys||[])\n    data = data.concat(treeData)\n\n    state.data = data\n    return state\n  },\n\n  PREPEND: function(ostate, opts={}, control){\n    let state = this.curState\n    let data = state.data\n    let oTreeKeys = control.saxer.get('treeKeys')\n    let prependData = [].concat(opts.data || [])\n\n    const [treeKeys, treeData] = setItemKey(prependData)\n    oTreeKeys = treeKeys.concat(oTreeKeys)\n    \n    control.saxer.set('treeKeys', oTreeKeys||[])\n    data = treeData.concat(data)\n\n    state.data = data\n    return state\n  },\n\n  /*\n    opts:{\n      index: {number}\n      query: {Json}\n    }\n  */\n  DELETE: function(ostate, opts={}, control){\n    let state = this.curState\n    let data = state.data\n    let oTreeKeys = control.saxer.get('treeKeys')\n\n    if (opts.index || opts.index == 0) {\n      const tIndex = findIndex(data, {attr: {'data-treeid': opts.index}})\n\n      let oriItem = data[tIndex] \n      // let oriItem = data[opts.index] \n      let oldKey = oriItem.key\n      if (oriItem) {\n        updateTreeKeys(control, oldKey)\n        data.splice(tIndex, 1);\n      }\n    }\n    else if(opts.query) {\n      const index = findIndex(data, opts.query)\n      let oriItem = data[index]\n      let oldKey = oriItem.key\n      if (oriItem) {\n        updateTreeKeys(control, oldKey)\n        data.splice(index, 1)\n      }\n    }\n    state.data = data\n    return state\n  },\n\n  // ========== 状态控制 ===========\n\n  LOADING: function(ostate, opts={}){\n    let state = this.curState\n    if (!state.over) {\n      state.loading = opts.loading || true\n      state.pulldown = false\n    }\n    return state\n  },\n\n  LOADED: function(ostate, opts={}){\n    let state = this.curState\n    if (!state.over) {\n      state.loading = false\n      state.pulldown = false\n    }\n    return state\n  },\n\n  OVER: function(ostate, opts={}){\n    let state = this.curState\n    state.loading = false\n    state.pulldown = false\n    state.trigger = false\n    state.over = opts.over || true\n    return state\n  },\n\n  PULLDOWN: function(ostate, opts={}){\n    let state = this.curState\n    state.loading = false\n    state.over = false\n    state.pulldown = opts.pulldown || true\n    return state\n  },\n\n  TRIGGER: function(ostate, opts={}){\n    if (!this||!this.state) return\n    let state = this.curState\n    state.loading = false\n    state.pulldown = false\n    state.over = false\n    state.trigger = opts.trigger || true\n    return state\n  },\n}\n\nlet idrecode = []\nlet indexcode = []\nfunction _getGroups(dataAry, idf){\n  let nsons = []\n\n  let sons = filter(dataAry, (o, jj) => {\n    if (o.parent == idf) {\n      indexcode.push(jj)\n      return o.parent == idf\n    }\n  })\n\n  sons.forEach( (son, ii) => {\n    if (son.idf && idrecode.indexOf(son.idf) == -1) {\n      idrecode.push(son.idf)\n      nsons = nsons.concat(son).concat(_getGroups(dataAry, son.idf))\n    } else {\n      nsons = nsons.concat(son)\n    }\n  })\n  return nsons\n}\n\n// let myParentsIndex = []\n// let myParents = []\n\n/**\n * [查找特定idf的数据，]\n * @param  {[type]} dataAry [description]\n * @param  {[type]} idf     [description]\n * @return {[type]}         [description]\n */\nfunction findParents(dataAry, idf){\n  let _parentIndex\n  const myParents = []\n  const item = find(dataAry, (o,ii)=>o.idf==idf)\n\n  if (item && item.parent) {\n    const p = find(dataAry, (o, ii)=>{\n      _parentIndex = ii\n      return o.idf==item.parent\n    })\n    if (p){\n      myParents.push({index: _parentIndex, content: p})\n      myParents.concat(findParents(dataAry, item.parent))\n    }\n  }\n  return myParents\n}\n\nfunction updateTreeKeys(control, oldkey, newKey) {\n  const treeKeys = control.saxer.get('treeKeys')\n  let ii = findIndex(treeKeys, {hashKey: oldkey})\n  if (newKey) {\n    treeKeys[ii].key = newKey\n  } else {\n    treeKeys.splice(ii, 1);\n  }\n}\n\nfunction valideIndex(index) {\n  return index || index == 0 ? true : false\n}\n\nfunction getHashKey(prefix=\"treex_\") {\n  return uniqueId(prefix)\n}\n\nfunction saveTreeKeys(control, params) {\n  params = params ? [].concat(params) : []\n  control.saxer.set('treeKeys', params)\n  // if (params.length) {\n  // }\n}\n\nfunction setItemKey(datas=[], depth=0, parentIndex, hkey, part) {\n  const myData = []\n  const myKeys = []\n  let start = datas.startIndex||0\n\n  for (let ii = 0, jj = start; ii < datas.length; ii++, jj++) {\n    let item = datas[ii]\n    const itemKey = getHashKey()\n    let keyItem = valideIndex(parentIndex)\n    // ? { index: jj, hashKey: itemKey, depth: depth, belong: { index: parentIndex, hashKey: hkey, part: part } }\n    ? { index: jj, hashKey: itemKey, depth: depth, belong: { hashKey: hkey, part: part } }\n    : { index: jj, hashKey: itemKey, depth: depth}\n    myKeys.push(keyItem)\n\n    if (isString(item) || isNumber(item) || React.isValidElement(item)) {\n      const newItem = {title: item, key: itemKey}\n      myData.push(newItem)\n    } \n    else if (isObject(item)) {\n      item.key = item.key||itemKey\n      const [subItemKeys, newItem] = setSubItemKey(item, jj, itemKey, ++depth)\n      myKeys.concat(subItemKeys)\n      myData.push(newItem)\n    }\n  }\n  \n  return [myKeys, myData]\n}\n\nfunction setSubItemKey(item, index, hashKey, depth) {\n  let _liKeys=[], _bodyKeys=[], _ftKeys=[], _dotKeys=[]\n  if (item.li) {\n    let li = [].concat(item.li)\n    let [liKeys, liData] = setItemKey(li, depth, index, hashKey, 'li')\n    _liKeys = liKeys\n    item.li = liData\n  }\n\n  if (item.body) {\n    let body = [].concat(item.body)\n    let [bodyKeys, bodyData] = setItemKey(body, depth, index, hashKey, 'body')\n    _bodyKeys = bodyKeys\n    item.body = bodyData\n  }\n\n  if (item.footer) {\n    let footer = [].concat(item.footer)\n    let [ftKeys, ftData] = setItemKey(footer, depth, index, hashKey, 'footer')\n    _ftKeys = ftKeys\n    item.footer = ftData\n  }\n\n  if (item.dot) {\n    let dot = [].concat(item.dot)\n    let [dotKeys, dotData] = setItemKey(dot, depth, index, hashKey, 'dot')\n    _dotKeys = dotKeys\n    item.dot = dotData\n  }\n\n  const itemKeys = [..._liKeys, ..._bodyKeys, ..._ftKeys, ..._dotKeys]\n  return [itemKeys, item]\n}\n\nfunction App(opts){\n  const [treeKeys, treeInitData] = setItemKey(opts.props.data)\n  opts.props.data = treeInitData || []\n  const treeX = Aotoo(Tree, Actions, opts)\n  saveTreeKeys(treeX, treeKeys)\n  treeX.extend({\n    // 重写setProps方法\n    setProps: function (props = {}) {\n      if (props.data) {\n        const [treeKeys, treeInitData] = setItemKey(props.data)\n        props.data = treeInitData || []\n        saveTreeKeys(this, treeKeys)\n        this.config.props = props\n      }\n    },\n    // 重写setConfig方法\n    setConfig: function (config = {}) {\n      if (config.props && config.props.data) {\n        const [treeKeys, treeInitData] = setItemKey(config.props.data)\n        config.props.data = treeInitData || []\n        saveTreeKeys(this, treeKeys)\n        this.config = config\n      }\n    },\n    update: function(params) {\n      this.$update(params)\n    },\n    append: function(params) {\n      this.$append(params)\n    },\n    prepend: function(params) {\n      this.$prepend(params)\n    },\n    delete: function(params) {\n      const that = this\n      if (params) {\n        if (Array.isArray(params)) {\n          params.forEach(function(param) {\n            setTimeout(() => {\n              that.$delete(param)\n            }, 50);\n          })\n        } else {\n          this.$delete(params)\n        }\n      }\n    },\n    loading: function(params) {\n      this.$loading(params)\n    },\n    loaded: function(params) {\n      this.$loaded(params)\n    },\n    over: function(params) {\n      this.$over(params)\n    },\n    pulldown: function(params) {\n      this.$pulldown(params)\n    },\n    trigger: function(params) {\n      this.$trigger(params)\n    },\n    /**\n     * data {Array} 完整的数据\n     * idf  {String}  指定父级id\n     * feather  {Boolean}  true = 是否返回完整数据，false = 返回完整的ID\n     */\n    getGroups: function(data, idf, feather){\n      data = data||this.data||[]\n      idrecode = []\n      indexcode = []\n      const index = findIndex(data, o=>o.idf==idf)\n      indexcode.push(index)\n      let groups = _getGroups(data||[], idf)\n      // if (feather) return groups\n      if (feather) {\n        let temp = []\n        indexcode.forEach( $id => {\n          let sonFeather = data[$id]\n          sonFeather['__index'] = $id\n          temp.push(sonFeather)\n        })\n        return temp\n      }\n      return indexcode\n    },\n\n    getParents: function(data, idf){\n      data = data||this.data||[]\n      return findParents(data, idf)\n    },\n\n    findAndUpdate: function(query, target){\n      const data = this.data||[]\n      if (query) {\n        const index = findIndex(data, query)\n        if (index) {\n          this.dispach('UPDATE', {\n            index: index,\n            data: target\n          })\n        }\n      }\n    }\n  })\n  return treeX\n}\n\nexport default function tree(opts){\n  let dft = {\n    props: {\n      data: [],\n      loading: false,\n      header: '',\n      footer: '',\n      itemClass: '',\n      listClass: '',\n      itemMethod: ''\n    },\n    theme: '',\n    autoinject: true,\n    rendered: ''\n  }\n  dft = merge(dft, opts)\n  return App(dft)\n}\n\nexport function pure(opts){\n  return tree(opts)\n}\n"]}